## Section 6.4: Profiling DPU

Section 6.4 states a number of experimental conclusions about the percentage of
the run time spent in the most important sub-procedures implemented by DPU.
In the sections below we address each of the claims made in paper.

We use [Callgrind] and [KCachegrind] to validate our statements. DPU comes with
a handy commandline option `--callgrind` that will run DPU under `callgrind`
when DPU is invoked with the option.

The benchmarks used for these experiments are as follows:

```sh
$ cd sec6.4-profiling/
$ ls -l
[LIST HERE]
```

We run DPU in with optimal POR exploration (`-k 0`).
For simplicity of evaluation we include the `callgrind.out.*` files generated by
`callgrind` when DPU is ran on the above benchmarks. The files are available in
the [folder callgrind.out](callgrind.out), but can be generated as follows:

```sh
COMMANDS to generate all files
```

[Callgrind]: http://valgrind.org/docs/manual/cl-manual.html
[KCKCachegrind]: http://kcachegrind.sourceforge.net/

### Callgrind + KCachegrind Premiere

10-line tutorial evaluating the performance of the program `ls`.


### Claim 1: Bla

FIXME

Let us take benchmark `cav18/bench/multiprodcon.c` for example.
* We run *multiprodcon.c* with *Optimal algorithm (k = 0)* and *valgrind* option:

```sh
dpu ./cav18/bench/multiprodcon.c -k 0 --callgrind
```

* Option `--callgrind` will put performance information in a file of the format *callgrind.out...*
In our case, we changed their names for better readability, for example *callgrind.out.mpc* for
benchmark *multiprodcon.c*.
* Open the file with kcachegrind from your terminal by the command:

```
kcachegrind callgrind.out.mpc
```

we will get the screen as follows:

![] img/main-screen.png

Performance information could be found as follows:
* In left panel, you will see the performance of major functions in descendant
  order where you are highlighted at main function by default.
* The details of selected function (in this case, it is main) are displayed in
  the right panel which is devided in two parts: upper one for callers and the
  lower for callees.

![] img/callee-screen.png

We here concern the callees. Look at the graph in the *Call Graph* tab, we can
see the hierachy of calls from main while its performance details are shown in
*All Calles* tab. Among the major callees, `dpu::get_por_analysis()` counts for
62.73%, while `dpu::opts::parse(...)` does 15.27%, totally take 78% of the run
time of `dpu::main(...)` for executing the program *multiprodcon.c*.

You can easily do the same analysis for the rest of benchmarks. We find about
the other benchmarks:

| Benchmarks  |  get_por_analysis | opts::parse |
| --------------- | ------------------ | -------------  |
| DISP (5,3)      | 62.74                 |    15.28 |
| DISP (5,4)      | 62.7415             |    15.28 |
| MPC()            | 64.55                 |    14.85 |
| PI(5)               | 64.55                 |    14.85 |
| MPAT()           | 64.55                 |     14.85 |
| SPAT             |  ....

This supports what we mention in Section 6.4 of the paper about program executing time.

### Claim 2: Bla

FIXME

### Claim 3: Bla

FIXME
